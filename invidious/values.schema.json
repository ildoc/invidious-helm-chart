{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Invidious Helm Chart Values Schema",
  "description": "Schema for validating Invidious Helm chart values",
  "properties": {
    "replicaCount": {
      "type": "integer",
      "minimum": 1,
      "maximum": 1,
      "description": "Number of replicas (limited to 1 to avoid database deadlocks)"
    },
    "image": {
      "type": "object",
      "properties": {
        "repository": {
          "type": "string",
          "pattern": "^[a-z0-9]([a-z0-9.-]*[a-z0-9])?(/[a-z0-9]([a-z0-9.-]*[a-z0-9])?)*$"
        },
        "tag": {
          "type": "string",
          "minLength": 1
        },
        "pullPolicy": {
          "type": "string",
          "enum": ["Always", "IfNotPresent", "Never"]
        }
      },
      "required": ["repository", "tag", "pullPolicy"]
    },
    "service": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["ClusterIP", "NodePort", "LoadBalancer"]
        },
        "port": {
          "type": "integer",
          "minimum": 1,
          "maximum": 65535
        }
      }
    },
    "gateway": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable Gateway API HTTPRoute"
        },
        "gatewayName": {
          "type": "string",
          "description": "Name of the Gateway to attach to"
        },
        "gatewayNamespace": {
          "type": "string",
          "description": "Namespace of the Gateway"
        },
        "hostnames": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Hostnames that this HTTPRoute responds to"
        }
      }
    },
    "secrets": {
      "type": "object",
      "properties": {
        "companionKey": {
          "type": "string",
          "minLength": 1,
          "description": "Companion authentication key"
        },
        "hmacKey": {
          "type": "string",
          "minLength": 1,
          "description": "HMAC signing key"
        },
        "postgresqlPassword": {
          "type": "string",
          "minLength": 1,
          "description": "PostgreSQL password"
        },
        "postgresqlUsername": {
          "type": "string",
          "minLength": 1,
          "description": "PostgreSQL username"
        }
      },
      "description": "Secret values for development (use existingSecret for production)"
    }
  },
  "required": ["image", "service"]
}
